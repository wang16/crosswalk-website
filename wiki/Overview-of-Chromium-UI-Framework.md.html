<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-type" content="text/html;charset=utf-8">
  <link rel="stylesheet" type="text/css" href="/wiki/css/gollum.css" media="all">
  <link rel="stylesheet" type="text/css" href="/wiki/css/editor.css" media="all">
  <link rel="stylesheet" type="text/css" href="/wiki/css/dialog.css" media="all">
  <link rel="stylesheet" type="text/css" href="/wiki/css/template.css" media="all">
  

  <!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="/wiki/css/ie7.css" media="all">
  <![endif]-->

  <script>
      var baseUrl = '/wiki';
      var pageFullPath = 'Overview-of-Chromium-UI-Framework';
  </script>
  <script type="text/javascript" src="/wiki/javascript/jquery-1.7.2.min.js"></script>
  <script type="text/javascript" src="/wiki/javascript/mousetrap.min.js"></script>
  <script type="text/javascript" src="/wiki/javascript/gollum.js"></script>
  <script type="text/javascript" src="/wiki/javascript/gollum.dialog.js"></script>
  <script type="text/javascript" src="/wiki/javascript/gollum.placeholder.js"></script>
  <script type="text/javascript" src="/wiki/javascript/editor/gollum.editor.js"></script>

  <script type="text/javascript" src="/wiki/custom.js"></script>

  <title>Overview of Chromium UI Framework</title>
</head>
<body>

<script>
Mousetrap.bind(['e'], function( e ) {
  e.preventDefault();
  window.location = "/edit" + window.location.pathname;
  return false;
});
</script>
<div id="wiki-wrapper" class="page">
<div id="head">
  <h1>Overview of Chromium UI Framework</h1>
  <ul class="actions">
    <li class="minibutton">
      <div id="searchbar">
        <form action="/wiki/search" method="get" id="search-form">
        <div id="searchbar-fauxtext">
          <input type="text" name="q" id="search-query" value="Search&hellip;" autocomplete="off">
          <a href="#" id="search-submit" title="Search this wiki">
            <span>Search</span>
          </a>
        </div>
        </form>
      </div>    </li>
    <li class="minibutton"><a href="/wiki/"
       class="action-home-page">Home</a></li>
    <li class="minibutton"><a href="/wiki/pages"
      class="action-all-pages">All</a></li>
    <li class="minibutton"><a href="/wiki/fileview"
    class="action-fileview">Files</a></li>
    <li class="minibutton jaws">
      <a href="#" id="minibutton-new-page">New</a></li>
    <li class="minibutton jaws">
      <a href="#" id="minibutton-rename-page">Rename</a></li>
    <li class="minibutton"><a href="/wiki/edit/Overview-of-Chromium-UI-Framework"
       class="action-edit-page">Edit</a></li>
    <li class="minibutton"><a href="/wiki/history/Overview-of-Chromium-UI-Framework"
       class="action-page-history">History</a></li>
  </ul>
</div>
<div id="wiki-content">
<div class="">
  <div id="wiki-body" class="gollum-markdown-content">
    <div class="markdown-body">
      <p>We have two option: using aura, not using aura. If turning off aura, chromium uses Gtk in Linux and Win32 in Window.</p>

<h1>How content shell integrate Gtk toolkit.<a class="anchor" id="How-content-shell-integrate-Gtk-toolkit." href="#How-content-shell-integrate-Gtk-toolkit."></a></h1>

<h2>Look at Gtk window creation.<a class="anchor" id="Look-at-Gtk-window-creation." href="#Look-at-Gtk-window-creation."></a></h2>

<p>content shell creates WebContent via content api. Under content api layer, Gtk widget is created. We can get the Gtk widget pointer via content api. It means we will tightly depend on specific platform.</p>

<p>In Shell.cc, after creating WebContent, create Gtk window and several Gtk widgets (e.g. button, url field)
After that, Shell add Gtk widget of WebContent to a container widget. GetNativeView() returns gfx::NativeView type, but in linux it is GtkWidget.
<code>gtk_container_add(GTK_CONTAINER(vbox_), web_contents_-&gt;GetView()-&gt;GetNativeView());</code></p>

<p>Following picture can help you see how content shell launches.
<img src="http://www.diagrammr.com/png?zx=0.5609126044437289&amp;key=d6tP4hX5mnk" alt="launching Browser process" /></p>

<h2>Integration point<a class="anchor" id="Integration-point" href="#Integration-point"></a></h2>

<p>If you are familiar with Gtk, it is easy to implement something like Minibrowser. You can get GtkWidget for contents via <code>web_contents_-&gt;GetView()-&gt;GetNativeView()</code>, and then just attach it to a container widget.</p>

<p>When loading pages that uses accelerated compositing, Gpu process actually draws XWindow buffer of Gtk widget. However, you don't need afraid. content api guarantees there is no data race of Window buffer between Browser process and Gpu process. It is implementation detail under the hood of content api. Just use Gtk widget of WebContents as normal Gtk Widget.</p>

<h2>Weak point<a class="anchor" id="Weak-point" href="#Weak-point"></a></h2>

<p>aura is brand new. chromium developer may put high priority on aura rather than old UI framework. Gtk way perhaps will be deprecated.</p>

<p>If we use aura, normal button and url field also have a benefit of GPU. For example, android chromium has a tab switching animation. Something like this animation can be more smooth with aura.</p>

<h1>How content shell integrate aura.<a class="anchor" id="How-content-shell-integrate-aura." href="#How-content-shell-integrate-aura."></a></h1>

<h2>Integration point<a class="anchor" id="Integration-point" href="#Integration-point"></a></h2>

<p>When turning on aura, we can not use our custom Gtk widget (as well as other platform UI toolkit). aura draws web content and url field in Gpu process. Using aura means we draw everything via only aura framework.</p>

<p>For example, if you want to add color chooser, how do you that? Using Gtk color picker widget? Unfortunately, you must implement color chooser window (aura term) for four ports: linux, mac, window and android.
So chromium developers are implementing color chooser window now. <a href="https://sites.google.com/a/chromium.org/dev/developers/design-documents/aura/ash-color-chooser">Ash color chooser</a></p>

<p>If we need something that chromium does not use yet, it is very tricky to implement it.</p>

<h2>Weak point<a class="anchor" id="Weak-point" href="#Weak-point"></a></h2>

<p>As mentioned, it is not proper for embedded WebView. Aura is framework itself. It is very hard to integrate with other framework.</p>

<p>aura is development stage. If you use chrome with aura, you can feel it is very creepy. When moving window, I often encountered crash.</p>

<p>In my opinion, our first target is Tizen. It is difficult to implement libxwalk.so for Tizen also.</p>

<h1>Reference<a class="anchor" id="Reference" href="#Reference"></a></h1>

<ul><li><a href="http://luxtella.blogspot.de/2013/05/chromium-launching-process.html">Understading Chromium Content shell</a></li>
<li><a href="http://luxtella.blogspot.de/2013/05/how-gpu-process-draws-contents-on.html">How Gpu process draws contents on the surface of Browser process's window in chromium.</a></li>
<li><a href="https://sites.google.com/a/chromium.org/dev/developers/design-documents">UI Framework and Graphics in chrome doc</a></li>
</ul>
    </div>
  </div>
  </div>

</div>
<div id="footer">
  <p id="last-edit">Last edited by <b>James Ketrenos</b>, 2013-09-01 21:04:08</p>
  <p>
    <a id="delete-link" href="/wiki/Overview-of-Chromium-UI-Framework" data-confirm="Are you sure you want to delete this page?"><span>Delete this Page</span></a>
  </p>
</div>
</div>

<form name="rename" method="POST" action="/wiki/rename/Overview-of-Chromium-UI-Framework">
  <input type="hidden" name="rename"/>
  <input type="hidden" name="message"/>
</form>


</body>
</html>
